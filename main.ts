enum ActionKind {
    Walking,
    Idle,
    Jumping,
    Dead,
    Flying
}
namespace SpriteKind {
    export const Ground = SpriteKind.create()
    export const Cloud = SpriteKind.create()
}
function initGround () {
    ground1 = sprites.create(img`
        ...................................................................................7777...........................................................................
        ..................................................................................7....7..........................................................................
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777......77777777777777777....77777777777777777777777777777777777777777777777777777
        .........................................................................................................7777.....................................................
        ..................................................................................................................................................................
        ..bbbb..b.......................b..bbbb.........................bbbb..b.............b..........................bbbb..b...........b..bbb.................b..bbb....
        ..................................................................................................................................................................
        ...............bbbb..b.........................bbbb.b.......b..............bb.b........bbbb..b.....bbbb..b..................b...............bbbb..b...............
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        `, SpriteKind.Ground)
    ground2 = sprites.create(img`
        .....................................................7777..................7777...................................................................................
        ....................................................7....7................7....7..................................................................................
        7777777777777777777777777777777777777777777777777777......7777777777777777......7777777777777777777777777777777777777777777777777777777777777777777777777777777777
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ....bbb..b.................bbb..b...........b..bbbb..........................b.............b..bbbb.........................bbbb..b.......................b..bbbb..
        ..................................................................................................................................................................
        ...............b..bbbb...............b..................b..bbbb.....b..bbbb........b.bb..............b.......b.bbbb.........................b..bbbb...............
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        ..................................................................................................................................................................
        `, SpriteKind.Ground)
    ground1.setPosition(scene.screenWidth() / 2, 120)
    ground2.setPosition(ground1.x + scene.screenWidth(), 120)
    ground1.vx = -100
    ground2.vx = -100
    ground1.z = 2
    ground2.z = 2
}
function createPterodactyl () {
    pterodactyl = sprites.createProjectileFromSide(img`
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        .......................cccc.....
        .....................cccc.......
        ...................cccc.........
        ...........cc.....ccccc.........
        ..........cc....cccccc..........
        .........cc.....ccccc...........
        ........ccc....ccccc............
        .......ccccc..ccccc.............
        ......ccccccccccccccccc.........
        ......ccccccccccccc.............
        .....cc.c...ccccccccc...........
        .....c..c..cccc.................
        ..........cccc..................
        ..........cc....................
        ..........c.....................
        ..........c.....................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        `, ground1.vx, 0)
    pterodactyl.y = 70
    pterodactyl.z = 2
    animation.attachAnimation(pterodactyl, fly)
    animation.setAction(pterodactyl, ActionKind.Flying)
}
function initPiggy () {
    piggy = sprites.create(img`
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ......................3333.....
        ......................3dd3.....
        ...........333333333.33dd3.....
        ........33333333333333dd3......
        .......333333333333333333......
        .......3333333333333333333.....
        ......33333333333333333333.....
        ..3...33333333333333338833.....
        .33..333333333333333338833333..
        .3..33333333333333333333333333.
        .33.33333333333333333333332323.
        ..3333333333333333333333333333.
        ...333333333333333333333333333.
        .....333333333333333333333333..
        ......33333333333333333333.....
        ......33333333333333333333.....
        .......333333333333333333......
        ........3333333333333333.......
        ........3333333333333333.......
        ........3333333333333333.......
        ........33333......33333.......
        .........333........333........
        .........333........333........
        .........eee........eee........
        `, SpriteKind.Player)
    idle = animation.createAnimation(ActionKind.Idle, 600)
    idle.addAnimationFrame(img`
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ......................3333.....
        ......................3dd3.....
        ...........333333333.33dd3.....
        ........33333333333333dd3......
        .......333333333333333333......
        .......3333333333333333333.....
        ......33333333333333333333.....
        ..3...33333333333333338833.....
        .33..333333333333333338833333..
        .3..33333333333333333333333333.
        .33.33333333333333333333332323.
        ..3333333333333333333333333333.
        ...333333333333333333333333333.
        .....333333333333333333333333..
        ......33333333333333333333.....
        ......33333333333333333333.....
        .......333333333333333333......
        ........3333333333333333.......
        ........3333333333333333.......
        ........3333333333333333.......
        ........33333......33333.......
        .........333........333........
        .........333........333........
        .........eee........eee........
        `)
    animation.attachAnimation(piggy, idle)
    run = animation.createAnimation(ActionKind.Walking, 100)
    run.addAnimationFrame(img`
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ......................3333.....
        ......................3dd3.....
        ...........333333333.33dd3.....
        ........33333333333333dd3......
        .......333333333333333333......
        .......3333333333333333333.....
        ......33333333333333333333.....
        ..3...33333333333333338833.....
        .33..333333333333333338833333..
        .3..33333333333333333333333333.
        .33.33333333333333333333332323.
        ..3333333333333333333333333333.
        ...333333333333333333333333333.
        .....333333333333333333333333..
        ......33333333333333333333.....
        ......33333333333333333333.....
        .......333333333333333333......
        ........3333333333333333.......
        ........3333333333333333.......
        ........3333333333333333.......
        ........33333......33333.......
        .........333........eee........
        .........333...................
        .........eee...................
        `)
    run.addAnimationFrame(img`
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ......................3333.....
        ......................3dd3.....
        ...........333333333.33dd3.....
        ........33333333333333dd3......
        .......333333333333333333......
        .......3333333333333333333.....
        ......33333333333333333333.....
        ......33333333333333338833.....
        .....333333333333333338833333..
        ....33333333333333333333333333.
        ....33333333333333333333332323.
        ...333333333333333333333333333.
        ..3333333333333333333333333333.
        333..333333333333333333333333..
        3.....33333333333333333333.....
        ......33333333333333333333.....
        .......333333333333333333......
        ........3333333333333333.......
        ........3333333333333333.......
        ........3333333333333333.......
        ........33333......33333.......
        .........eee........333........
        ....................333........
        ....................eee........
        `)
    animation.attachAnimation(piggy, run)
    jump = animation.createAnimation(ActionKind.Jumping, 200)
    jump.addAnimationFrame(img`
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ......................3333.....
        ...........333333333.33dd3.....
        ........33333333333333dd3......
        .......333333333333333333......
        .......3333333333333333333.....
        ......33333333333333333333.....
        ......33333333333333338833.....
        .....333333333333333333333333..
        ....33333333333333333333333333.
        333.33333333333333333333332323.
        3.3333333333333333333333333333.
        ...333333333333333333333333333.
        .....333333333333333333333333..
        ......33333333333333333333.....
        ......33333333333333333333.....
        .......333333333333333333......
        ........3333333333333333.......
        ........33333......33333.......
        .........eee........eee........
        ...............................
        ...............................
        ...............................
        ...............................
        `)
    animation.attachAnimation(piggy, jump)
    dead = animation.createAnimation(ActionKind.Dead, 200)
    dead.addAnimationFrame(img`
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ...............................
        ......................333......
        ......................3d3......
        ...........333333333.33d3......
        ........33333333333333dd3......
        .......333333333333333333......
        .......3333333333333aaaaa3.....
        ......33333333333333addda3.....
        ......33333333333333adada3.....
        .....333333333333333addda33....
        ....3333333333333333aaaaa333...
        ....333333333333333333333333...
        ...3333333333333333333333333...
        ..33333333333333333333333333...
        .33..3333333333333333333333....
        .3....33333333333333333333.....
        .33...33333333333333333333.....
        ..3....333333333333333333......
        ........3333333333333333.......
        ........3333333333333333.......
        ........3333333333333333.......
        ........33333......33333.......
        .........333........333........
        .........333........333........
        .........eee........eee........
        `)
    animation.attachAnimation(piggy, dead)
    piggy.z = 3
    piggy.setPosition(20, 94)
}
controller.anyButton.onEvent(ControllerButtonEvent.Pressed, function () {
    if (piggy.y == 94 && end == 0) {
        piggy.vy = -160
        animation.setAction(piggy, ActionKind.Jumping)
        music.playTone(587, music.beat(BeatFraction.Quarter))
    }
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.Projectile, function (sprite, otherSprite) {
    end = 1
    animation.setAction(piggy, ActionKind.Dead)
    pause(50)
    game.over(false, effects.dissolve)
})
function initFlyAnimation () {
    fly = animation.createAnimation(ActionKind.Flying, 350)
    fly.addAnimationFrame(img`
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        .......................cccc.....
        .....................cccc.......
        ...................cccc.........
        ...........cc.....ccccc.........
        ..........cc....cccccc..........
        .........cc.....ccccc...........
        ........ccc....ccccc............
        .......ccccc..ccccc.............
        ......c9ccccccccccccccc.........
        ......ccccccccccccc.............
        .....cc.c...ccccccccc...........
        .....c..c..cccc.................
        ..........cccc..................
        ..........cc....................
        ..........c.....................
        ..........c.....................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        `)
    fly.addAnimationFrame(img`
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ..........ccc...................
        .........ccc....................
        ........ccc....ccccc............
        .......ccccc..ccccc.............
        ......c9ccccccccccccccc.........
        ......ccccccccccccc.............
        .....cc.c...ccccccccc...........
        .....c..c..cccc..cccccc.........
        ..........cccc...cccccc.........
        .....................cccc.......
        .......................cccc.....
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        `)
}
let cloud: Sprite = null
let obstacle: Sprite = null
let choice = 0
let dead: animation.Animation = null
let jump: animation.Animation = null
let run: animation.Animation = null
let idle: animation.Animation = null
let piggy: Sprite = null
let fly: animation.Animation = null
let pterodactyl: Sprite = null
let ground2: Sprite = null
let ground1: Sprite = null
let end = 0
game.setDialogCursor(assets.image`myImage0`)
scene.setBackgroundColor(1)
initGround()
initPiggy()
initFlyAnimation()
info.setScore(0)
end = 0
let difficulty = 3
game.showLongText("Trendaro nyní opravujeme. Mezitím si zahrajte... :-)", DialogLayout.Top)
game.onUpdate(function () {
    if (piggy.y < 94) {
        piggy.ay = 400
    } else {
        piggy.ay = 0
        piggy.y = 94
        if (end == 0) {
            animation.setAction(piggy, ActionKind.Walking)
        }
    }
})
game.onUpdateInterval(50, function () {
    info.changeScoreBy(1)
    if (info.score() % 100 == 0) {
        music.baDing.play()
    }
    if (info.score() % 1000 == 0) {
        if (info.score() / 1000 % 2 == 0) {
            difficulty = difficulty - 1
        } else {
            difficulty = difficulty + 1
        }
    }
})
game.onUpdateInterval(1000, function () {
    ground1.vx += -1
    ground2.vx += -1
})
game.onUpdateInterval(1000, function () {
    choice = randint(0, difficulty)
    // console.logValue("difficulty", difficulty)
    // console.logValue("choice", choice)
    if (choice == 0) {
        obstacle = sprites.createProjectileFromSide(assets.image`myImage1`, ground1.vx, 0)
        obstacle.y = 92
        obstacle.z = 2
    } else if (choice == 1) {
        obstacle = sprites.createProjectileFromSide(img`
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ...b5b..........
            ....b5b.........
            .....cb.........
            ....bbbbbb......
            ...b55555bb.....
            ..fd55f1d5bb....
            ..c4d5ff155b....
            ..44ddbfd55b....
            b44444555dbbdddb
            .b4444455b555dbb
            ..b55555d5555cdb
            .b555555b55dcddc
            .b5555555bccddbc
            .bd55555ddddddc.
            ..bb555dddddbc..
            ...bbcccccccc...
            `, ground1.vx, 0)
        obstacle.y = 94
        obstacle.z = 2
    } else if (choice == 2) {
        obstacle = sprites.createProjectileFromSide(img`
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ................
            ....cccccc......
            ...c677776c.....
            ..c77777777c....
            .c6777777776c...
            .c7c6666c777c...
            .f76f66f6777f...
            .f7777777777f...
            ..f77776c776fc..
            ...fcccc776f77c.
            ..c727776cf7777c
            .c77277cfc6776cc
            c111176fcc666c..
            f1111166c6666f..
            f61111166666cf..
            .f6111111666f...
            ..cccccccccf....
            `, ground1.vx, 0)
        obstacle.y = 91
        obstacle.z = 2
    } else if (choice == 3) {
    	
    } else if (choice == 4) {
        createPterodactyl()
    }
})
game.onUpdateInterval(1500, function () {
    if (Math.percentChance(40)) {
        cloud = sprites.createProjectileFromSide(img`
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................9999.99.........
            ...............99.....9.........
            .............999......999.......
            .............9..........9999....
            .............9.............9....
            ..........9999.............999..
            .........99..................9..
            .....99999...................99.
            .....9........................9.
            .99.99..9......................9
            99.......99999999999999999999999
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            `, ground1.vx / 4, 0)
        cloud.y = randint(20, 60)
        cloud.setKind(SpriteKind.Cloud)
        cloud.z = 1
    }
})
forever(function () {
    if (ground2.x < -1 * (scene.screenWidth() / 2)) {
        ground2.x = ground1.x + scene.screenWidth()
    }
})
forever(function () {
    if (ground1.x < -1 * (scene.screenWidth() / 2)) {
        ground1.x = ground2.x + scene.screenWidth()
    }
})
